# Проект 2: Расширенная версия проекта №1 с использованием Spring Data JPA, Hibernate ORM и Spring Boot

## Описание
Данный проект представляет собой переписанную версию [проекта №1](https://github.com/TusyaSonne/Spring_course_project1) на Spring Boot с использованием **Spring Data JPA** и **Hibernate ORM**, а также с расширенным функционалом. 

Вместо DAO реализованы **репозитории** и **сервисы**.

---

## Новый функционал

### 1. Пагинация для книг
Книг может быть много, и они могут не помещаться на одной странице в браузере. Чтобы решить эту проблему:  
- Метод контроллера теперь умеет выдавать не только все книги разом, но и разбивать выдачу на страницы. Нумерация страниц начинается с нуля.  
Обычный запрос на `http://localhost:8080/books`:
![image](https://github.com/user-attachments/assets/a2591503-2a42-4a68-bb73-acaebb4b017c)\
Запрос `http://localhost:8080/books?page=1&books_per_page=3`:
![image](https://github.com/user-attachments/assets/352cf826-eef4-4a0f-a6e4-bc73728e098c)\

---

### 2. Сортировка книг по году
- Метод контроллера теперь поддерживает выдачу книг в отсортированном порядке по году издания.  
Запрос `http://localhost:8080/books?sort_by_year=true`:
![image](https://github.com/user-attachments/assets/bcfe77fc-ab48-4b05-aba4-581c825d3ac4)

#### Также пагинация и сортировка могут работать вместе
- Запрос `http://localhost:8080/books?sorted_by_year=true&page=1&books_per_page=3`:
![image](https://github.com/user-attachments/assets/876b19c2-2e48-4550-a855-5ff4dad1db14)

---

### 3. Реализован поиск книг
- Вводим в поле на странице начальные буквы названия книги.  
- Получаем:
  - Информацию о книге с возможностью перейти на её страницу;
  - Если книга сейчас находится у кого-то, также получаем имя этого человека.  
  - Запросы на `http://localhost:8080/books/search`:
    ![image](https://github.com/user-attachments/assets/afdcc08d-14a7-49d8-bc60-3b98aa1652aa)\
    ![image](https://github.com/user-attachments/assets/fc38e5e2-f9b4-44f5-a8c8-fe69f920fc23)\
    ![image](https://github.com/user-attachments/assets/4596867c-b4e7-43a8-99cd-59c412d3c048)



---

### 4. Автоматическая проверка просрочки возврата книги
- Реализована система, которая автоматически проверяет, просрочил ли человек возврат книги (если прошло более 10 дней с момента взятия книги).
  - Человек, не просрочивший сдачу книг:
    ![image](https://github.com/user-attachments/assets/6eb898e1-d363-4bf3-9c95-5e4a087a4cae)
  - Человек, не сдавший книгу вовремя:
    ![image](https://github.com/user-attachments/assets/e226ede3-6873-45ad-b202-32608bd6da8d)

---

## Мануал

1. Клонируйте репозиторий в желаемую директорию:
   ```bash
   git clone https://github.com/TusyaSonne/Project2Boot.git
   ```

2. Создайте базу данных:
   - Создайте БД PostgreSQL
   ```sql
   CREATE DATABASE project1;

   CREATE TABLE person
    (
    id         INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    fullname   VARCHAR(100) NOT NULL UNIQUE,
    birthyear  INT NOT NULL CHECK (birthyear > 1900)
    );


   CREATE TABLE book
    (
    id                 INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    title              VARCHAR(100) NOT NULL,
    author             VARCHAR(100) NOT NULL,
    year               INT NOT NULL CHECK (year < 2025),
    person_id          INT REFERENCES person(id) ON DELETE SET NULL,
    date_of_assignment TIMESTAMP
    );

   ```

3. Настройте базу данных:
   Отредактируйте файл **application.properties**, введя данные своей БД
   ```
   # (Data source)
    spring.datasource.driver-class-name=org.postgresql.Driver
    spring.datasource.url=jdbc:postgresql://localhost:5432/project1
    spring.datasource.username=ВАШ_ЮЗЕРНЕЙМ
    spring.datasource.password=ВАШ_ПАРОЛЬ
   ```

5. Запустите проект через вашу IDE (при разработке проекта использовалась IntelliJ IDEA 2024.1.4 Ultimate Edition).

6. Можете тестировать приложение, все возможные запросы описаны в [проекте №1](https://github.com/TusyaSonne/Spring_course_project1) и этом README-файле.
